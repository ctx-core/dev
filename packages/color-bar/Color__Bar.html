<script>
	import { createEventDispatcher } from 'svelte'
	import { andand } from '@ctx-core/function'
	import { _present__array } from '@ctx-core/array'
	import { _class, _style } from '@ctx-core/html'
	import { log, debug } from '@ctx-core/logger'
	const logPrefix = '@ctx-core/color-bar/Color__Bar.html'
	const dispatch = createEventDispatcher()
	export let ARR__label
	export let ARR__representation
	export let ARR__title
	export let ARR__value
	export let ARR__weight
	export let ARR__class
	$: class__ = $$props.class || ''
	$: class__labels = _class({ present: _present__array(ARR__label) })
	function _style__li(weight) {
		return _style({
			'-webkit-box-flex': weight,
			flex: weight
		})
	}
	function __click(event, IDX) {
		dispatch('click', {
			event,
			IDX,
			label: ARR__label && ARR__label[IDX],
			representation: ARR__representation && ARR__representation[IDX],
			title: ARR__title && ARR__title[IDX],
			value: ARR__value && ARR__value[IDX],
			weight: ARR__weight && ARR__weight[IDX],
		})
	}
</script>

<div class="Color__Bar {class__}">
	<ul class="data">
		{#each ARR__title||[] as title,IDX}
			<li
				class="{ARR__class[andand(ARR__value, IDX) || 0]}"
				title="{title || ''}"
				style="{_style__li(andand(ARR__weight, IDX))}"
				on:click="{event => __click(event, IDX)}"
			>
				{andand(ARR__representation, IDX)}
			</li>
		{/each}
	</ul>
	<ul
		class="labels {class__labels}"
	>
		{#each ARR__title||[] as title,IDX}
			<li
				class="label"
				title="{title || ''}"
				style="{_style__li(andand(ARR__weight, IDX))}"
				on:click="{event => __click(event, IDX)}"
			>
				<div>{andand(ARR__label, IDX)}</div>
			</li>
		{/each}
	</ul>
</div>

<style type="text/scss">
	:global(.Color__Bar) {
		box-sizing: border-box;
		display: block;
		:global(*) {
			box-sizing: border-box;
		}
		:global(ul) {
			display: -webkit-box;
			display: flex;
			height: 1rem;
			width: 100%;
			margin: 0;
			padding: 0;
			overflow: hidden;
			-webkit-box-align: center;
			-webkit-flex-align: center;
			align-items: center;
			-webkit-box-pack: center;
			justify-content: center;
			text-align: center;
			list-style: none;
			&.data {
				:global(li) {
					align-items: center;
					justify-content: center;
				}
			}
			&.labels {
				display: none;
				&.present {
					display: -webkit-box;
					display: flex;
				}
			}
			:global(li) {
				-webkit-box-flex: 1;
				flex: 1;
				height: 1rem;
				font-size: 1rem;
				line-height: 1rem;
				padding-top: 0.05em;
				width: auto;
				color: white;
				border-left: 2px solid #FFF;
				&.label {
					position: relative;
					color: #000000;
					font-weight: normal;
					> :global(div) {
						position: absolute;
						display: -webkit-box;
						display: flex;
						-webkit-box-align: center;
						-webkit-flex-align: center;
						align-items: center;
						-webkit-box-pack: center;
						-webkit-flex-pack: center;
						justify-content: center;
						width: 100%;
						text-align: center;
						white-space: nowrap;
					}
				}
			}
		}
	}
</style>